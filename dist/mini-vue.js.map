{"version":3,"file":"mini-vue.js","sources":["../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["class Observe {\n\tconstructor(value) {\n\t\tthis.walk(value);\n\t}\n\n  // 对象\n\twalk(obj) {\n\t\tconst keys = Object.keys(obj);\n\t\tfor (let i = 0; i < keys.length; i++) {\n\t\t\tdefineReactive(obj, keys[i], obj[keys[i]]);\n\t\t}\n\t}\n}\n\n// 数据响应式（核心）\nexport function defineReactive(obj, key, val) {\n\n  // 递归，使对象值也进行响应式\n  observe(val)\n  // 数据劫持\n\tObject.defineProperty(obj, key, {\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t\tget() {\n\t\t\tconsole.log(`🚀 ~ 访问值 ${key}`, val);\n\t\t\treturn val;\n\t\t},\n\t\tset(value) {\n\t\t\tval = value;\n\t\t\tconsole.log(`🚀 ~ 设置值 ${key}`, value);\n\t\t},\n\t});\n}\n\nexport function observe(value) {\n\tif ((value !== null && typeof value === 'object') || Array.isArray(value)) {\n\t\treturn new Observe(value);\n\t}\n}\n","import { observe } from './observer/index';\n\n// 数据代理\nexport function proxy(target, sourceKey, key) {\n\tObject.defineProperty(target, key, {\n\t\tenumerable: true,\n\t\tconfigurable: true,\n\t\tget() {\n\t\t\treturn target[sourceKey][key];\n\t\t},\n\t\tset(val) {\n\t\t\treturn (target[sourceKey][key] = val);\n\t\t},\n\t});\n}\n\nexport function initState(vm) {\n\tconst opts = vm.$options;\n\tif (opts.props) {\n\t\tinitProps(vm);\n\t}\n\n\tif (opts.methods) {\n\t\tinitMethods(vm);\n\t}\n\n\tif (opts.data) {\n\t\tinitData(vm);\n\t}\n\n\tif (opts.computed) {\n\t\tinitComputed(vm);\n\t}\n\n\tif (opts.watch) {\n\t\tinitWatch(vm);\n\t}\n}\n\nfunction initProps() {}\n\nfunction initMethods() {}\n\nfunction initData(vm) {\n\t// 传入的 data\n\tlet data = vm.$options.data;\n\n\tdata = vm._data = typeof data === 'function' ? data.call(vm) : data || {};\n\tconsole.log('🚀 ~ file: state.js ~ line 33 ~ initData ~ data', data);\n\n\t// 将 data 代理到 vm 上，可通过 this.dataKey 访问\n\tfor (const key in data) {\n\t\tif (Object.hasOwnProperty.call(data, key)) {\n\t\t\tproxy(vm, '_data', key);\n\t\t}\n\t}\n\n  // 观测数据 -- 响应式数据核心\n\tobserve(data);\n}\n\nfunction initComputed() {}\n\nfunction initWatch() {}\n","import { initState } from './state';\n\nexport function initMixin(Vue) {\n\tVue.prototype._init = function (options) {\n\t\tconst vm = this;\n\t\tvm.$options = options;\n\n    // 初始化状态\n    initState(vm)\n\t};\n}\n","import { initMixin } from './init';\n\nfunction Vue(options) {\n\t// 初始化\n\tthis._init(options);\n}\n\ninitMixin(Vue);\n\nexport default Vue;\n"],"names":["Observe","value","walk","obj","keys","Object","i","length","defineReactive","key","val","observe","defineProperty","enumerable","configurable","get","console","log","set","Array","isArray","proxy","target","sourceKey","initState","vm","opts","$options","props","methods","data","initData","computed","watch","_data","call","hasOwnProperty","initMixin","Vue","prototype","_init","options"],"mappings":"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"}